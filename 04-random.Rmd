---
output:
  pdf_document: default
  html_document: default
always_allow_html: true
---
# Sattuma ja satunnaisuus tilastotieteessä {#luku4}

```{r random, echo=FALSE, fig.cap="Hauska kuva satunnaisuudesta.", fig.align='center', out.width = "100%"}
knitr::include_graphics("images/im_so_random.jpg")
```

Tässä luvussa pohdimme sattuman ja satunnaisuuden roolia tilastotieteessä ja tieteessä ylipäätään. Satunnaisuudella tarkoitetaan yleensä säännönmukaisuuden puuttumista ja ennustamattomuutta ja kenties juuri siksi sitä voidaan pitää yhtenä maailman vaikuttavimmista ilmiöistä. Jokainen haluaisi tietää mitä tuleman pitää ja siksi sattuma tekee elämästä mielenkiintoista: se vaikuttaa ja muokkaa niin meitä itseämme kuin meitä ympäröivää maailmaa mitä merkityksellisimmin tavoin - joskus jopa vasten tahtoamme ja usein vailla täyttä ymmärtystämme!

Ihmisen oma kokemus on kuitenkin altis kaikenlaisille virhepäätelmille, joita kutsutaan myös __kognitiivisiksi vinoumiksi__. Haluamme löytää systematiikkaa ja tarkoitusta kaaoksesta sekä merkityksiä ja syy-seuraussuhteita sellaisista tapahtumista, jotka kuuluvat normaalivaihtelun piiriin. Tällaisissa tilanteissa usein tilastollinen tarkastelu paljastaakin ilmiön todellisen, alkuperäisestä kuvitelmasta poikkeavan luonteen. Erottaakseen systemaattinen vaihtelu satunnaisesta ja ymmärtääkseen oikeasti merkityksellisiä syy-seuraussuhteita, satunnaisuutta on välttämätöntä ymmärtää. Tämä välttämättömyys pätee erityisesti tiedeyhteisön jäseniin, jotka pyrkivät tutkimaan ympäröivän maailman satunnaisia ilmiöitä. 

Tilastotiede perustuu satunnaisilmiöiden ja niiden generoimien aineistojen tutkimiseen, joten sen ymmärtäminen on keskeisessä roolissa niin tilastotieteen kuin muidenkin tieteiden ja lopulta maailman ymmärtämisessä.

## Satunnaisilmiöt ja satunnaismuuttujat tilastotieteessä {#alaluku41}

__Satunnaisilmiöt__

- Edellisestä luvusta muistamme, että tilastotieteellisen tutkimuksen kohteena on aina jokin tilastoyksikköjen tutkimusmuuttujista koostuva havaintoaineisto, jonka pohjalta tehdään päätelmiä perusjoukosta/populaatiosta. 
- Tilastolliset muuttujat tulkitaan satunnaisiksi, ja tilastollisen tutkimuksen tavoite onkin siis tutkia sitä populaatiotason satunnaisilmiötä, joka havaitut eli toteutuneet arvot on generoinut.
  - Yksi tilastotieteen olennainen tehtävä onkin kehittää  __tilastollisia malleja__, joiden avulla tutkimuksen kohteena olevaa satunnaisilmiöitä voidaan kuvata, selittää ja ennustaa.
  - Tilastollisen mallin satunnaisten piirteiden kuvaus perustuu  __todennäköisyyslaskentaan__.

::: {.defblock .mikko data-latex="{}"}
**Satunnaisilmiö**

Reaalimaailman ilmiö on satunnaisilmiö, jos seuraavat ehdot pätevät:

- Ilmiöllä on useita erilaisia tulosvaihtoehtoja.
- Sattuma määrää mikä tulosvaihtoehdoista toteutuu, eli yksittäistä tulosta ei voida tietää etukäteen.
- Vaikka tulos vaihtelee ilmiön toistuessa satunnaisesti, käyttäytyy tulosvaihtoehtojen suhteellisten osuuksien jakauma tilastollisesti stabiilisti ilmiön toistokertojen lukumäärän kasvaessa.
:::

- __Tilastollisella stabiiliudella__ tarkoitetaan sitä, että on mahdollista arvioida kuinka __todennäköisiä__ erilaiset tapahtumat, eli satunnaisilmiön tulosvaihtoehdot ovat. 
  - Toisin sanoen satunnaisilmiön tulosvaihtoehtoihin on liityttävä säännönmukaisuutta, jonka on tultava esille ilmiön toistuessa.

::: {.eblock .kimmo data-latex="{}"}
**Esimerkkejä satunnaisilmiöistä**  

- Helpoin esimerkki on uhkapelit, kuten kortti- ja noppapelit, arpajaiset, lotto tai ruletti: näitä käytetäänkin usein todennäköisyyslaskennan peruskursseilla satunnaisilmiöiden esittelyyn.
- Lukion biologian tunneilta muistetaan, että perinnöllisyyskin on osaltaan sattumaa: se määrää kummalta vanhemmalta perittävä geenikopio on peräisin.
  - Vastaavasti populaatiotasolla eri ominaisuuksien jakautuminen yksilöiden ja populaatioiden välillä on satunnaista.
  - Populaatiotaso voi tässä tarkoittaa esimerkiksi erilaisten eliöiden eri alueilla eläviä populaatioita, joiden välisiä eroja pyritään tutkimaan ja selittämään.
  - Vastaavasti ihmisten, ihmisryhmien ja ihmisten muodostamien organisaatioiden sisäisessä ja välisessä käyttäytymisessä on useita satunnaisia elementtejä.
- Jopa deterministiseen toimintaperiaatteeseen tähtäävässä tehdastuotannossa käy satunnaisia virheitä tuotteiden valmistusprosesseissa, jotka ilmenevät esimerkiksi viallisina tuotteina. 
- Vastaavasti luonnontieteellisiin mittauksiin liittyy mittausvirheitä, jotka kuuluvat satunnaisvaihtelun piiriin. Esimerkiksi varhaisissa valonnopeusmittauksissa mittausvirheet saattoivat olla suuriakin!
- Myös kvanttimekaniikan ja hiukkasfysiikan tutkimat ilmiöt ovat perusluonteeltaan satunnaisia.
:::

__Satunnaismuuttujat__

- Tilastollista vaihtelua ilmentävät tilastolliset muuttujat tulkitaan __satunnaismuuttujiksi__ ja havainnot (havaintoarvot) voidaan näin ollen tulkita näiden satunnaismuuttujien realisoituneiksi arvoiksi. Tällöin tilastollisen tutkimuksen kohteena on nämä havainnot generoinut _satunnaisilmiö_. 
  - Satunnaismuuttuja siis kuvaa tarkasteltavan mitattavan ominaisuuden (satunnais)vaihtelua tutkimuksen kohteiden, eli tilastoyksiköiden joukossa.
  - Mitattavan ominaisuuden mahdolliset arvot määräävät satunnaismuuttujan luonteen. Yleisesti satunnaismuuttujat jaetaan kahteen luokkaan:  __jatkuviin__ ja __diskreetteihin__. 
  - Satunnaismuuttujan __todennäköisyysjakauma__, määrää erilaisten tulosvaihtoehtojen todennäköisyyden ja mahdollistaa täten tilastollisen analyysin ja päättelyn. 
    - Satunnaisuus eroaa mielivaltaisesta prosessista siinä, että satunnaista ilmiötä voidaan kuvata jollakin __tilastollisella lailla/mallilla__ kun taas mielivaltaista prosessia ei.
  - Satunnaismuuttujat voidaan luokitella myös __kvalitatiivisiin__ ja __kvantitatiivisiin__ muuttujiin (ks. \@ref(alaluku53)).
  - Kvalitatiivisiin muuttujiin liittyy luokittelu- tai järjestysasteikko.
  - Kvantitatiivisiin muuttujiin välimatka- ja suhdeasteikko.

::: {.defblock .mikko data-latex="{}"}
**Satunnaismuuttuja** 

Satunnaismuuttuja (usein lyhyesti sm., englanniksi random variable, merkitään esim. $Y$, ja kutsutaan ajoittain myös stokastiseksi muuttujaksi) on todennäköisyyslaskennan peruskäsite, jolla tarkoitetaan satunnaisilmiön määräämää lukua.  

- Satunnaismuuttujan $Y$ realisoituvaa arvoa $y$ kutsutaan realisaatioksi tai toteumaksi.  

- Tilastollinen aineisto muodostuu useiden satunnaismuuttujien (tilastoyksiköiden tutkimusmuuttujien) realisoituneista arvoista.  

- Realisoituneiden arvojen vaihtelua tilastoyksiköiden välillä kutsutaan satunnaisvaihteluksi ja sitä kuvataan satunnaismuuttujan todennäköisyysjakaumalla.
:::

::: {.defblock .mikko data-latex="{}"}
**Jatkuvat ja diskreetit satunnaismuuttujat** 

- Satunnaismuuttuja $Y$ on jatkuva, jos se voi saada ylinumeroituvan määrän arvoja tai ts. minkä tahansa arvon joltain väliltä, kuten tyypillisesti minkä tahansa arvon joltain reaalilukuväliltä.
- Satunnaismuuttuja $Y$ on diskreetti, jos se voi saada vain joitain mahdollisia arvoja (vain yksittäisiä, äärellisen tai numeroituvasti äärettömän määrän, arvoja).     
  - Yksinkertaisimmillaan diskreetti satunnaismuuttuja $Y$ on kaksiarvoinen (binäärinen), jolloin sen mahdollisia arvoja tyypillisesti merkitään $y=0$ tai $y=1$.
:::


::: {.eblock .kimmo data-latex="{}"}
**Esimerkki: sademäärä satunnaismuuttujana**

- Huomista sadantaa eli sademäärää tietyllä alueella voidaan pitää (ennen huomista sadepäivää) satunnaismuuttujana $Y$ ja mitattua sademäärää (sadepäivän jälkeen) täten sademäärän yhtenä realisaationa $y$. 
  - Yleensä sademäärää kohdellaan jatkuvana muuttujana millilitroissa, joka jaetaan sadetta mitanneen astian suuaukon pinta-alalla.
  - Mikäli kuitenkin määritetään toteumaksi jonkin sademäärän raja-arvon, esimerkiksi yksi milli, ylittävä sademäärä, on kyseessä diskreetti kaksiarvoinen (binäärinen) muuttuja (sademäärä on joko yli tai alle yksi milli (litra neliömetrille)).
- Tutkija voisi olla esimerkiksi kiinnostunut sadannan eroista kuntien tai alueiden välillä tietyssä maasssa sekä tähän kenties vaikuttavista syistä.
  - Tätä tutkiakseen hän tarvitsisi tilastollisen aineiston tutkimus- ja taustamuuttujineen eri alueilta, joka voitaisiin kerätä esimerkiksi satunnaisotannalla asettamalla sadannan mittaavia astioita satunnaisesti kyseisille alueille.
:::

- Toisaalta ajoittain tietyn suureen/ilmiön mallinnuksessa voidaan perustellusti käyttää molempiin luokkiin kuuluvien satunnaismuuttuja- ja tilastollisen mallityypin vaihtoehtoja. 
  - Esimerkki: Esimerkiksi Suomen COVID19-tartuntatapauksia tutkittaessa, tartunnan saaneiden lukumäärä oli periaatteessa diskreetti satunnaismuuttuja, joka sai yksittäisen (kokonaisluku)arvon joka kuukausi, mutta käytännössä lukumäärät ovat tässä tapauksessa sen verran suuria, että niitä mallinnetaan tyypillisesti jatkuva-arvoisena muuttujana. 
  - Vastaavasti esimerkiksi potilaan jonotusaika päivystyksessä voi periaatteessa saada minkä tahansa arvon tietyltä reaalilukuväliltä ($[0,\infty)$, ts. mikä vain positiivinen arvo) ja tällöin käytettäisiin jatkuviin sm:jiin perustuvia tilastollisia menetelmiä.


## Satunnaisilmiöiden tilastollinen mallintaminen {#alaluku43}

- Seuraavaksi käydään vaiheittain läpi sitä, miten reealimaailman satunnaisilmiöitä voidaan tilastollisin menetelmin mallintaa. 
- Tilastollisen tutkimuksen lähtökohta on aina aineisto. Aineiston tulee kuvata tutkittavaa satunnaisilmiötä sillä tavalla, että esitettyihin tutkimuskysymyksiin ja/tai hypoteeseihin voidaan vastata. 
  - Aineiston sisältämät satunnaismuuttujat määräävät käytettävän tilastollisen mallin, jota lopulta käytetään hypoteesien testaamiseen. 
  - Kaikkiin näihin vaiheisiin syvennytään tulevissa jaksoissa vielä tarkemmin, mutta tämän osion tarkoituksena on havainnollistaa sitä, miten tilastotieteessä mallinnetaan satunnaisilmiöitä.

__Tilastollisen aineiston kerääminen__

- Tilastotieteessä __tilastollisen tutkimusaineiston keräämistä__ voidaan pitää hyvänä esimerkkinä satunnaisilmiöstä.
  - Voimme ajatella, että tilastollisen tutkimuksen kohteet on aina valittu arpomalla.
  - Arvonta on mainio esimerkki satunnaisilmiöstä, sillä siihen liittyy aina ennustamattomuutta: vaikka yksittäisen arvonnan tulosta ei voi tietää etukäteen, noudattaa se kuitenkin todennäköisyyden lakeja.
  - Koska arvonnan tulos, eli mitkä perusjoukon tilastoyksiköt tulevat valituksi, vaihtelee satunnaisesti arvontakerrasta toiseen, myös tutkimuksen kohteita kuvaavat tiedot vaihtelevat satunnaisesti arvontakerrasta toiseen.
  - Tutkimuksen kohteita kuvaavien tietojen käyttäytymisessä havaitaan kuitenkin arvontaa toistettaessa juuri sitä säännönmukaisuutta, jota kutsutaan tilastolliseksi stabiliteetiksi. __Tämä säännönmukaisuus on tilastollisen tutkimuksen kohde.__
  - Tilastollisen aineiston keräämistä, eli otantateoriaa, ja sen tavoitteita käsitellään Osan 1 luvussa \@ref(luku5) ja otantamenetelmiä vielä syvemmin Osan 2 luvussa \@ref(luku7). 
  
::: {.eblock .kimmo data-latex="{}"}
**Esimerkki: Tilastollisten aineistojen kerääminen arpomalla**  

- __Satunnaisotanta__: Otannalla^[\ Erityisesti erilaisten otantamenetelmien yhteydessä, joita tarkastellaan tarkemmin luvussa \@ref(luku7).] tarkoitetaan laveasti tutkimusaineistojen keräämisen menetelmiä. Erilaisten virhelähteiden kontrolloimiseksi tutkimuksen kohteet on syytä valita arpomalla. (Ks. Luku \@ref(luku5) ja \@ref(luku7)).  
- __Satunnaistetut kokeet__: Kokeellisessa tutkimuksessa tavoitteena on vertailla erilaisten käsittelyiden vaikutuksia kokeen kohteisiin. Erilaisten virhelähteiden kontrolloimiseksi käsittelyt on syytä arpoa kohteille.  

:::

- Satunnaisotannalla kerätyissä aineistoissa satunnaisuus perustuu siihen, että satunnaismuuttujien toteutuvat arvot (ja niistä lasketut tunnusluvut kuten keskiarvo) vaihtelevat satunnaisesti otoksesta toiseen, kun otokseen valikoituu satunnaisesti eri tilastoyksiköitä, joilta mitatut/kerätyt tutkimusmuuttujien arvot vaihtelevat.
  - Tämä vaihtelu on kuitenkin stabiilia, eli eri otokset ilmentävät samaa satunnaisilmiötä. 
  - Toisin sanoen, otantaa toistettaessa eri aineistojen sisältämä satunnaisvaihtelu on aineiston generoineen todennäköisyysjakauman mukaista myös otosten välillä.
  - Tilastotieteen tehtävä on tuottaa __tilastollisia malleja__ tälle satunnaisilmiöissä havaittavalle tilastolliselle stabiliteetille.

- Kerätyn (tai havaitun) aineiston pohjalta pyritään tekemään tutkimuskysymystä vastaavia päätelmiä tutkimuksen kohteena olevasta ja aineiston generoineesta satunnaisilmiöstä. 
  - Tutkimuskysymyksen tulee tilastollisessa tutkimuksessa olla sellainen, että sitä vastaavat testattavat hypoteesit koskevat aineiston generoinutta satunnaisilmiötä, jota mitatut tutkimusmuuttujat ilmentävät. 
  - Kun näin on, tutkimuskysymykseen voidaan vastata käytössä olevan aineiston avulla käyttäen tilastollisia menetelmiä.

__Tilastollisen muuttujan todennäköisyysjakauma__

- Tilastolliset menetelmät perustuvat todennäköisyyslaskennan^[Todennäköisyyslaskentaa käsitellään lyhyesti tulevissa luvuissa mutta varsinaisesti tarkemmin 2. periodin kurssilla [TILM3553 Todennäköisyyslaskennan peruskurssi](https://opas.peppi.utu.fi/fi/opintojakso/TILM3553/1734?period=2022-2024) ja (erityisesti sivuaineopiskelijoille) [TILM3568 Todennäköisyyslaskenta sivuaineopiskelijoille](https://opas.peppi.utu.fi/fi/opintojakso/TILM3568/3385?period=2022-2024).] tuloksiin ja tarjoavat keinon hallita satunnaisuuden aiheuttamaa epävarmuutta. 
- __Tilastolliset mallit__ perustuvat satunnaismuuttujan mahdollisten tulosvaihtoehtojen todennäköisyyksiä kuvaavalle __todennäköisyysjakaumalle__, joka määrää millä todennäköisyydellä satunnaismuuttuja saa erilaisia arvoja.
  - __Diskreetin satunnaismuuttujan__ todennäköisyysjakauma voidaan usein esittää taulukkomuodossa. Eri arvojen todennäköisyydet muodostavat kyseisen satunnaismuuttujan todennäköisyysjakauman, __pistetodennäköisyysfunktion__, jota voidaan havainnollistaa esimerkiksi pylväsdiagrammilla (ks. alla oleva esimerkki ja kuvaaja \@ref(fig:kannatusmittaus)). 
  - __Jatkuvan satunnaismuuttujan__ arvot muodostavat jonkin reaaliakselin välin, joka sisältää äärettömän määrän lukuja. Tämän vuoksi jatkuvan satunnaismuuttujan todennäköisyysjakauman esittäminen taulukon kautta ei ole luontevaa, vaan jakauma esitetään yleensä satunnaismuuttujan __tiheysfunktion__ avulla.
    - Pistetodennäköisyys- ja tiheysfunktiot siis määräävät satunnaismuuttujan mahdollisille arvoille todennäköisyydet väliltä $[0,1]$. 
- Havaitulle aineistolle perustettava tilastollinen malli perustuu satunnaismuuttujan todennäköisyysjakaumalle, joka riippuu yhdestä tai useammasta parametrista ja kuvaa kyseisen muuttujan säännönmukaista satunnaisvaihtelua.
  - Tilastollinen malli riippuu siis tehdystä todennäköisyysjakaumaoletuksesta sekä havaitusta aineistosta eli mielenkiinnon kohteena olevan satunnaismuuttujan realisaatioista.
  - Tavoitteena on pyrkiä arvioimaan sitä populaatiotason todennäköisyysjakaumaa, joka on tutkimusaineiston generonut.

::: {.eblock .kimmo data-latex="{}"}
**Esimerkki: Diskreetin aineiston jakauma: poliittisten puolueiden kannatusmittaus**  

- Poliittisten puolueiden kannatustutkimuksia mittaavia galluppeja tehdään erityisesti vaalien alla usean tilastollisia kyselytutkimuksia tekevän tahon toimesta.   
- Puoluevalintaa (tai valitsematta jättämistä) voidaan pitää äänestysikäisten keskuudessa satunnaismuuttujana, jolla on äärellinen määrä tulosvaihtoehtoja: puolueiden määrän lisäksi vastaaja voi ilmoittaa ettei tiedä ketä aikoo äänestää tai että ei aio äänestää ollenkaan.
- Täten puolueiden kannatus on diskreetti muuttuja ja kannatustutkimuksessa kohdepopulaatio on äänestysikäiset (täysi-ikäiset) Suomen kansalaiset.
- Tässä tapauksessa paras arvio todennäköisyydelle, että satunnaisesti valittu äänestysikäinen kansalainen äänestää tiettyä puoluetta (nk. suurimman uskottavuuden estimaatti, ks. luku \@ref(luku8)) on kyseisen puolueen saama osuus kaikista kyselyyn vastanneista.
- Oheisessa taulukossa on esitelty tuloksia Taloustutkimuksen Ylelle suorittamasta puolueiden eduskuntavaalikannatusta mittaavasta tutkimuksesta, jossa haastateltiin 2481 ihmistä puhelinhaastatteluina ja internetpaneelina aikavälillä 7.6.-2.7.2024.
  - Haastatelluista 1910 kertoi puoluekantansa ja tutkimuksen virhemarginaalin kerrottiin olevan suurimmillaan 1,9 prosenttiyksikköä suuntaansa (ks. Osan II luku \@ref(luku9)).
  - Nämä todennäköisyydet on esitetty alla olevassa taulukossa sekä kuvaajassa \@ref(fig:kannatusmittaus).

| Puolue    | SDP | VAS | KOK | KESK | RKP | KD | VIHR | PS | LIIK | MUU |
|:---------:|:---:|:---:|:---:|:----:|:---:|:--:|:----:|:--:|:----:|:---:|
| Kannatus-%|20,1 |11,6 |21,2 |12,2  |3,9  |3,7 |8,3   |15,3|1,9   |1,8  |

:::

```{r kannatusmittaus, warning = FALSE, message = FALSE, echo = FALSE, message = FALSE, fig.cap="Taloustutkimuksen Ylelle teettämän eduskuntavaalien kannatustutkimukseen vastanneiden valitsemien puolueiden osuus vastanneista.", fig.align='center', out.width = "100%"}
library(ggplot2)
library(dplyr)
theme_set(theme_bw())
#generate a normal distribution plot
kannatukset = c(20.1,11.6,21.2,12.2,3.9,3.7,8.3,15.3,1.9,1.8)/100
puolueet = c("SDP", "VAS", "KOK", "KESK", "RKP", "KD", "VIHR", "PS", "LIIK", "MUU")
ekdat = bind_cols("Kannatusosuus" = kannatukset, "Puolueet" = puolueet)
ekdat %>% arrange(desc(Kannatusosuus)) %>% ggplot(aes(x = Puolueet, y = Kannatusosuus, fill = Puolueet)) + geom_col() + 
  scale_fill_manual(values = c("lightblue", "darkgreen", "darkblue", "pink", "grey", "blue", "yellow", "darkred", "red", "green")) + theme_bw() + theme(legend.position="none")
```

__Parametrien estimointi ja niiden testaus__

- Satunnaisilmiötä kuvaava tilastollinen malli perustuu siis johonkin parametriseen todennäköisyysjakaumaan ja pyrkii approksimoimaan "todellista" aineiston generoinutta ilmiötä. 
  - Todennäköisyysjakaumat riippuvat __parametreista__ ja keskeinen oletus erityisesti klassisessa tilastotieteessä on, että aineiston generoinutta satunnaisilmiötä kuvaa jokin vakioinen mutta __tuntematon parametriarvo__ (tai niiden joukko).
  - Keskeinen tehtävä tilastotieteessä onkin pyrkiä __estimoimaan__, eli jollain keinolla arvioimaan, mitkä nämä tuntemattomat parametriarvot ovat, sillä ne kuvaavat aineiston generoinutta satunnaisilmiötä, joka lopulta on mielenkiinnon kohteena.

- Tilastollinen aineisto koostuu usean tilastoyksikön havaitusta tai mitatusta tutkimusmuuttujan (sm.) realisaatiosta ja tavoitteena on aineiston avulla arvioida sitä todennäköisyysjakaumaa, joka kyseiset realisoituneet arvot on generoinut.
  - Lähtökohtana voidaan siis pitää sitä, että tutkimusmuuttujan realisaatiot ovat peräisin samasta todennäköisyysjakaumasta. 
  - Tälle oletukselle voidaan perustaa havaintoaineiston yhteisjakauma, joka on se todennäköisyysjakauma joka aineiston on generoinut, mutta jonka parametriarvot ovat tuntemattomia.

- Tilastollisen mallin pohjana oleva todennäköisyysjakauma määrittää yhdessä havaintojen kanssa nk. __uskottavuusfunktion__, jota käytetään tuntemattomien parametriarvojen estimoimiseen.
  - Aineistoa kuvaavan tilastollisen mallin uskottavuus pyritään maksimoimaan, mikä tarkoittaa valitun todennäköisyysjakauman sovittamista havaintoaineistoon mahdollisimman hyvin.
  - Tässä nk. "suurimman uskottavuuden estimoinnissa"  aineiston generoiman (oletetun) todennäköisyysjakauman parametriarvot __estimoidaan__ (eli arvioidaan) käytettävän otoksen/aineiston avulla.
  - Perusjoukkoa parhaiten kuvaavan (eli "aineiston generoineen") parametrin arvo pyritään siis estimoimaan aineiston perusteella ja saatuja parametriarvoja kutsutaan __estimaateiksi__.
  - Suurimman uskottavuuden estimointiin syvennytään tarkemmin Osan II luvussa \@ref(luku8).

- Parametrien estimoinnin lisäksi usein __testataan__ parametreja koskevia oletuksia (eli hypoteeseja). 
  - Toisin sanoen, testaamalla arvioidaan tilastollisen mallin parametreihin liitettäviä hypoteeseja suhteessa aineistosta saatuihin estimaatteihin.
  - Näin voidaan testata, onko jokin ennustettu hypoteesi uskottava nyt havaitun aineiston valossa.

::: {.eblock .kimmo data-latex="{}"}
**Esimerkki: Testaus uskottavuuspohjaisessa tilastollisessa päättelyssä**  

- Palataan aiemmin esitettyyn kuviteltuun esimerkkiin tutkijasta, joka haluaa tutkia sademääriä.
- Sanotaan, että tutkija on kiinnostunut tutkimaan väitettä, jonka mukaan Turussa sataa yli keskimäärin 800 milliä vuodessa.
- Oletetaan lisäksi, että tutkijalla on käytettävänä satunnaisotantaan perustuva arvio Turun sademääristä vuosilta 1980-2023 ja että vuosittaiset sademäärät ovat riippumattomia ja samoin jakautuneet.
- Nyt tutkija voi perustaa väitteen tilastotieteellisen tutkimuksen muodostamalla tilastollisen mallin käytettävissä olevasta aineistosta.
:::

- Estimointi ja testaus ovat tilastolliseen tutkimukseen liittyvän __tilastollisen päättelyn__ keskeisiä välineitä, joiden avulla tutkittavasta ilmiöstä pyritään tekemään johtopäätöksiä siitä kerätyn havaintoaineiston perusteella.
  - Estimoitujen parametrien testaus voi vastata esimerkiksi seuraavanlaisiin kysymyksiin: 
    - Onko suomalaisten miesten keskipituus 180\ cm?
    - Vaikuttaako yliopistokoulutus tulevaisuuden ansioihin?
    - Auttaako tietty lääkeaine jonkin sairauden hoidossa?
    - Voiko osakemarkkinoiden tuottoja ennustaa?

- Parametrien testaus on osa tilastollista päättelyä, johon palataan tarkemmin luvussa \@ref(luku8)


## Tilastolliset tunnusluvut ja estimaattorit: esimerkkinä normaalijakauma {#alaluku44}

__Tilastolliset tunnusluvut__  

- Perehdytään seuraavaksi esimerkin avulla tilastollisiin tunnuslukuihin ja estimaattoreihin käyttäen hieman tilastotieteessä tarvittavaa matemaattista notaatiota.  
- Satunnaismuuttujan todennäköisyysjakauman tietoa voidaan tiivistää tunnuslukuihin, joista keskeisimpiä ovat __odotusarvo__, __varianssi__ ja __keskihajonta__.

::: {.defblock .mikko data-latex="{}"}
**Odotusarvo** 

Satunnaismuuttujan $Y$ odotusarvo $\text{E}(Y)$ kuvaa satunnaismuuttujan odotettavissa olevaa arvoa.

- Muodostamalla satunnaiskokeen tulosten __painotettu keskiarvo__, jossa kunkin tuloksen painona on vastaavan tapauksen todennäköisyys, niin saatua arvoa sanotaan odotusarvoksi $\text{E}(Y)$. 
- Odotusarvo kuvaa jakauman painopistettä.
- Merkinnän $\text{E}(Y)$ käyttö juontaa juurensa englannin kielen sanoihin "odotus"\, expectation, ja "odotusarvo"\, expected value.
:::

::: {.eblock .kimmo data-latex="{}"}
**Esimerkki: Nopanheiton odotusarvo** 

Perinteikäs esimerkki odotusarvosta on tavallisen kuusitahoisen nopan silmäluvun odotusarvo. Nopanheitto on diskreetti satunnaisilmiö ja tavallisen painottamattoman nopan tapauksessa jokaisen silmäluvun todennäköisyys on yhtä suuri. Merkitään nopan silmälukua (sm) $Y$ ja sen realisaatiota $y$. Nopan silmäluvun realisaatioiden mahdolliset arvot ovat $Y = \{1,2,3,4,5,6\}$ ja niiden todennäköisyydet ovat $P(Y=y) = \frac{1}{6}$.

Nopanheiton silmäluvun odotusarvo määritetään siis painotettuna keskiarvona $$E(Y) = \sum_{i=1}^6 y \cdot P(Y=y)  = 1 \cdot \frac{1}{6} + 2 \cdot \frac{1}{6} + 3 \cdot \frac{1}{6} + 4 \cdot \frac{1}{6} + 5 \cdot \frac{1}{6} + 6 \cdot \frac{1}{6} = \frac{7}{2} = 3.5$$
:::

- Odotusarvon lisäksi kiinnostuksen kohteena on usein jakauman keskittyneisyys (hajaantuneisuus). Ts. kun halutaan puolestaan kuvata satunnaismuuttujan arvojen vaihtelua, tutkitaan todennäköisyysjakauman __varianssia__ ja __keskihajontaa__.

::: {.defblock .mikko data-latex="{}"}
**Varianssi** 

Satunnaismuuttujan $Y$ hajontaa voidaan mitata varianssilla
$$
\mathrm{Var}(Y) = \text{E}\Big[\Big(Y-\text{E}(Y)\Big)^2\Big],
$$
tai sen neliöjuuren eli __keskihajonnan__ avulla
$$
\text{D}(Y) = \sqrt{\mathrm{Var}(Y)}.
$$

- Mitä lähempänä nollaa keskihajonta ja varianssi ovat, sitä todennäköisempää on, että satunnaismuuttujan arvo on lähellä odotusarvoa.
- Merkintöjen $\mathrm{Var}(Y)$ ja $\text{D}(Y)$ taustalla on englannin kielen sanat variance (varianssi) ja deviation, joka tarkoittaa "poikkeamaa"/"hajontaa". 
:::

- Odotusarvon ja varianssin (keskihajonnan) tavanomaiset **estimaattorit** ovat otoskeskiarvo ja otosvarianssi (otoshajonta), joihin tutustuaan alla normaalijakauman erityistapauksessa.

__Normaalijakauman parametrit__

- Käydään seuraavaksi läpi tilastollisen mallin parametrien merkitystä normaalijakauman tapauksessa. 
- Normaalijakauma on yksi keskeisimpiä ja tärkeimpia todennäköisyysjakaumia tilastotieteessä ja sen avulla voidaan helposti kuvata jakauman parametrien vaikutusta sen muotoon.
  - Normaalijakauman tiheysfunktio määrittelee parven normaalijakaumia kun parametreille (vakioille) $\mu$ ja $\sigma^2$ annetaan erilaisia arvoja. 
  - Alla olevassa kuvassa \@ref(fig:normaalijakauma) on kuvattu erilaisia normaalijakauman tiheysfunktion muotoja eri parametriarvoilla.

```{r normaalijakauma, warning = FALSE, message = FALSE, echo = FALSE, message = FALSE, fig.cap="Normaalijakaumien muotoja eri parametriarvoilla.", fig.align='center', out.width = "100%"}
library(ggplot2)
theme_set(theme_bw())
#generate a normal distribution plot
ggplot(data.frame(x = c(-6, 8)), aes(x = x)) +
  stat_function(fun = dnorm, args = c(-2,0.5), aes(col = "N(-2,0.5)")) + 
  stat_function(fun = dnorm, args = c(0,1), aes(col = "N(0,1)")) +
  stat_function(fun = dnorm, args = c(0,2), aes(col = "N(0,2)")) + 
  stat_function(fun = dnorm, args = c(3,2), aes(col = "N(3,2)")) + 
  ggtitle("Erilaisia normaalijakaumia") +  
  labs(x = "", y = "") + 
  labs(colour = "Väri") 
```

- Tiheysfunktio kuvaa satunnaismuuttujan eri tulosvaihtoehtojen (vaaka-akselin numeeriset arvot) todennäköisyyksiä.
  - Täten esimerkiksi satunnaismuuttujan, joka on normaalisti jakautunut odotusarvonaan $3$ ja varianssinaan $2$, merkitään $Y \thicksim N(3,2)$, realisaatiot ovat keskittyneet odotusarvon ympärille niin, että suuret poikkeamat odotusarvosta kumpaankaan suuntaan ovat vähemmän todennäköisiä kuin pienemmät poikkeamat.
  - Toisin sanoen, kuten yllä, normaalijakauman parametreista odotusarvo kuvaa sitä mikä on satunnaisilmiön generoimien realisaatioiden odotettavissa oleva arvo. Täten odotusarvo kuvaa normaalijakauman tapauksessa tiheysfunktion "sijaintia", normaalijakauman symmetrian ansiosta. Huomioi, että tämä on erityisesti normaalijakauman ominaisuus eikä yleispätevä sääntö. 
  - Vastaavasti varianssi kuvaa sitä, kuinka paljon realisaatiot keskimäärin poikkeavat odotusarvosta. Kuvassa \@ref(fig:normaalijakauma) huomataan, että suuremmat varianssin arvot "leventävät" normaalijakauman tiheysfunktiota, jolloin suuremmat poikkeamat ovat suhteellisesti todennäköisempiä.
    - Varianssin yksikkö on satunnaismuuttujan yksikkö korotettuna toiseen potenssiin, joten sen tulkinta on hankalaa. Tällöin on usein helpompaa hahmottaa satunnaismuuttujan hajontaa varianssin neliöjuurella, eli keskihajonnalla, jonka yksikkö on sama kuin satunnaismuuttujan yksikkö.
  
__Otoskeskiarvo ja otosvarianssi normaalijakauman parametrien estimaattoreina__

- Kuten yllä mainittiin, tilastollisessa tutkimuksessa on tavoitteena estimoida aineiston generoineen todennäköisyysjakauman tuntemattomat parametrit käyttäen havaintoaineistoa.
- Normaalijakauman tapauksessa tämä on suoraviivaista, joten esitellään nyt lyhyesti normaalijakauman parametrien estimaattorit: otoskeskiarvo ja otosvarianssi.
  - Tätä varten esitellään hieman tarvittavaa matemaattista notaatiota.

- Merkitään satunnaismuuttujaa isolla kirjaimella, $Y$, ja satunnaismuuttujan realisaatiota pienellä kirjaimella $y$. Otoskokoa, eli otokseen osallistuvien tilastoyksiköiden määrää merkitään $n$:llä ja tilastoyksiköitä indeksöidään alaindeksillä $i=1,\ldots,n$. 
  - Otoksen poimimisen jälkeen satunnaismuuttujat $Y_1, \ldots, Y_n$ saavat havaituiksi arvoikseen havaintoarvot $y_1, \ldots, y_n$ (ts. $Y_1=y_1, \ldots, Y_n = y_n$).
  - Näin havaintoaineisto on siis __satunnaisotos__, joka voidaan määritellä tarkemmin seuraavasti.

::: {.defblock .mikko data-latex="{}"}
**Satunnaisotos normaalijakaumasta**  

Olkoot $Y_1, \ldots, Y_n$ riippumattomia ja normaalisti jakautuneita satunnaismuuttujia, joille pätee $Y_i \thicksim N(\mu,\sigma^2)$, jossa $\mu$ ja $\sigma^2$ ovat normaalijakauman muodon määräävät parametrit.  

Parametrien $\mu$ ja $\sigma^2$ arvoja ei tunneta ja tavoitteena onkin päätellä, __estimoida__, niiden arvot lopulta käytettävissä olevasta aineistosta.
:::

__Otoskeskiarvo__

- Normaalisti jakautuneiden havaintojen (satunnaismuuttujien) $Y_1, \ldots, Y_n$ __otoskeskiarvo__ on  

$$
\bar{Y} = \frac{1}{n}(Y_1 + \cdots + Y_n) = \frac{1}{n} \sum_{i=1}^{n} Y_i
$$

  - Yksittäisen otoksen otoskeskiarvo on tällöin sm:jien realisaatioiden aritmeettinen keskiarvo

$$
\bar{y} = \frac{1}{n} \sum_{i=1}^{n} y_i.
$$

  - Otoskeskiarvo on satunnaismuuttuja, jonka saama arvo vaihtelee satunnaisesti otoksesta toiseen johtuen satunnaisotannasta.
  - Kun satunnaismuuttujat ovat samoin jakautuneet odotusarvonaan $\mu$, on otoskeskiarvo jakauman odotusarvon harhaton estimaattori, ts. 

$$\text{E}(\bar{Y}) = \mu$$

- Täten aineiston otoskeskiarvo kuvaa aineiston perusjoukon tilastollisen mallin odotusarvoa.
  
__Otosvarianssi__

- Aineiston sisältämää vaihtelua kuvataan __otosvarianssilla__
$$
S^2= \frac{1}{n-1} \sum_{i=1}^{n} (y_i - \bar{y})^2.
$$

  - Vastaavasti sm:jien vaihtelua perusjoukon tasolla kuvataan __populaatiovarianssilla__

$$
\sigma^2= \frac{1}{N} \sum_{j=1}^{N} (Y_j - \mu)^2,
$$
jota otosvarianssi harhattomasti estimoi.

- Otoskeskiarvo $\bar{Y}$ ja otosvarianssi $S^2$ ovat siis satunnaismuuttujia, joiden saamat arvot vaihtelevat satunnaisesti otoksesta toiseen, mutta jotka toimivat saatavilla olevasta aineistosta laskettuna kohdepopulaation jakauman parametrien estimaattoreina.
  - Estimaattoreihin, niiden ominaisuuksiin ja tarkempaan teoriaan perehdytään tarkemmin Osan II luvussa \@ref(luku8).




\

## Tilastotieteen koulukunnat

- Tilastotiede voidaan jakaa kahteen merkittävään paradigmaan sen mukaan, miten **tilastolliseen päättelyyn**, ml. hypoteeseihin ja niiden testaamiseen, suhtaudutaan. Näitä ovat __klassinen eli frekventistinen tilastotiede__ sekä __Bayesilainen tilastotiede__. Tarkastellaan seuraavaksi minkälaisia eroja ja yhtäläisyyksiä näiden koulukuntien välillä on.

\

__Frekventistinen tilastotiede__  

- Klassisessa eli frekventistisessä tilastotieteessä ajatellaan että hypoteesien testaaminen tulee perustua yksinomaan havaittuun aineistoon ja siihen liitettävään tilastolliseen malliin. 
- Nimi "frekventistinen" juontuu siitä, että tilastollisen mallin perustana oleva todennäköisyysjakauma määrittää satunnaismuuttujan mahdollisten arvojen todennäköisyydeksi niiden suhteellisen osuuden äärettömästä määrästä realisaatioita, ts. niiden suhteellisen frekvenssin. 
- Klassisessa tilastotieteessä havaittuun aineistoon _sovitetaan_ tilastollinen malli, joka vastaa saatua aineistoa parhaiten.
  - Tämä tilastollinen malli voidaan (useimmiten) perustaa nk. __uskottavuusfunktioon__, joka on _aineiston_ sekä yhden tai useamman _parametrin_ funktio ja joka saavuttaa suurimman arvonsa nk. "suurimman uskottavuuden pisteessä". 
  - Uskottavuusfunktio kertoo kuinka todennäköisenä havaittua aineistoa voidaan pitää, mikäli sen oletetaan olevan peräisin vastaavasta mallista jollain parametriarvolla. 
    - Täten ne parametriarvot, joilla uskottavuusfunktion arvo maksimoituu, _kuvaavat aineiston generoimaa prosessia parhaiten_, annettuna malli- eli jakaumaoletus. 
  - Uskottavuusfunktioihin ja tilastollisten mallien parametrien estimointiin tutustuaan tarkemmin kurssin seuraavan osan luvussa \@ref(luku7).

- Tutkimuskysymyksen mukaisia hypoteeseja testataan tilastollisen mallin avulla: havaittu aineisto määrittää uskottavuusfunktion perusteella sellaiset hypoteesit, jotka jäävät joko voimaan tai tulevat hylätyiksi.

- Klassisessa tilastotieteessä hypoteesien testaus perustuu siis vain aineistoon eli tilastollinen päättely on induktiivista: aineiston avulla otosta koskeva päätelmä voidaan yleistää koskemaan perusjoukkoa. 
  - Kaikki päättely on toki alisteista tehdyille oletuksille koskien käytettävää tilastollista mallia.

\

__Bayesilainen tilastotiede__

- Bayesilainen tilastotiede on tilastotieteen toinen suuri paradigma ja on saanut nimensä englantilaiselta harrastelijamatemaatikko ja presbyteeripappi [Thomas Bayesilta](https://fi.wikipedia.org/wiki/Bayesil%C3%A4inen_tilastotiede), jota pidetään Bayesilaisen tilastotieteen isänä.
- Bayesilainen tilastotiede ulottaa todennäköisyyskäsityksen, eli tn-jakauman, myös aineistoa koskevien hypoteesien puolelle: kuinka todennäköisenä jotain hypoteesia voidaan pitää jo ennen tutkimusaineiston keräämistä?
  - Myös Bayesilaisessa tilastotieteessä hyödynnetään uskottavuusfunktiota, mutta hypoteesien testaus ei perustu niinkään frekventistiseen ajatukseen todennäköisyyksistä suhteellisina osuuksina äärettömässä sarjassa.
  - Bayesilaiset perustavat sen sijaan hypoteesien testaamisen tutkimuskysymystä koskevien ennakkokäsitysten päivittämiselle sen jälkeen, kun aineisto on havaittu. 
  - Nämä ennakkokäsitykset voidaan kuvata todennäköisyysjakaumana, priorijakaumana, jota päivitetään ns. posteriorijakaumaksi kun aineisto havaitaan. Näin päättely perustuu priorijakauman ja aineiston uskottavuusfunktion väliselle kompromissille!
- Ajatusta ennakkokäsityksistä todennäköisyyksinä käytetään niin Bayesilaisen tilastotieteen kritiikkinä kuin puolustuksena.
  - Lopulta olemme kaikki Bayesilaisia: jokaisella on sisäisiä ennakkokäsityksiään, myös tutkijoilla! Nämä ennakkokäsitykset voivat perustua esimerkiksi aiempaan tutkittuun tietoon, mutta myös uskomuksiin.
  - Prioritiedon hyödyntäminen tilastollisessa tutkimuksessa on usein perusteltua, mutta prioritiedon käyttämistä voidaan pitää myös subjektiivisena ja täten ongelmallisena tulosten luotettavuuden kannalta.
  - Bayesilaista tilastotiedettä tarkastellaan tarkemmin esimerkiksi kursseilla [TILM3577 Bayes-päättely](https://opas.peppi.utu.fi/fi/opintojakso/TILM3577/6969) sekä [TILM3601 Bayes-laskenta](https://opas.peppi.utu.fi/fi/opintojakso/TILM3601/21033).


## Sattuman rooli tieteenteossa: Vale-emävale-tilasto? {#alaluku46}

Erityisesti nykypäivänä ei-tieteellinen tieto ja tarkoituksellinen disinformaatio, joita perustellaan heppoisin havainnoin, leviävät internetissä kulovalkean tavoin. On tiedeyhteisön ja tutkijoiden moraalinen vastuu taistella näitä uskomuksia vastaan __popularisoimalla tiedettä__. Tämä saattaa kuitenkin ajoittain jopa pahentaa ongelmaa, sillä popularisoinnissa päteviltäkin tutkijoilta voi unohtua _satunnaisuuden voima_.^[\ Tämä jakso perustuu osin psykometriikan yliopisto-opettajan Jari Lipsasen [blogiin](https://blogs.helsinki.fi/med-viikonjuttu/2021/02/22/vale-emavale-tilasto) vuodelta 2021.]

- Kuten todettua, tilastollisessa tutkimuksessa mielenkiinnon kohteena on satunnaisilmiöiden tutkiminen ja erityisesti systemaattisen ja satunnaisen vaihtelun (signaalin ja kohinan) erottaminen sekä muuttujien välisten riippuvuuksien tutkiminen.
  - Kiinnostuksen kohteena on siis hyvin harvoin vain jokin yksittäinen tunnusluku, kuten keskiarvo, varianssi tai korrelaatio (palaamme näihin myöhemmin luvussa \@ref(luku6)).
  - Tieteen popularisointi on yksi tutkijoiden ja yliopistojen tiedeyhteisön tärkeimmistä yhteiskunnallisista tehtävistä, mutta valitettavan usein se typistyy yksittäisen viimeisimmän tutkimustuloksen esittelyksi.

- Yliopistoyhteisössä kuitenkin luonnollisesti luotamme kumuloituneeseen tutkittuun tietoon ja tiedämme, että __yksittäinen tutkimus on vasta hyvä alku__.
  - Ihmistieteitä, kuten ilmeisesti erityisesti psykologiaa sekä osin myös muiden ohella lääke- ja taloustiedettä, on viimeisen vuosikymmenen ajan puhuttanut paljon niin sanottu __replikaatiokriisi__, sillä useaa arvostettuakaan tutkimusta ei ole saatu __toistettua eli replikoitua__.
  - On ymmärrettävää, että replikaatiokriisi, varsinkin jos se on (alakohtaisesti) laajalle levinnyttä, murentaa kansalaisten luottamusta tieteellisiin tuloksiin. 
  - Toistettavuus on yksi tutkimuksen peruskriteereistä, joka erottaa tieteellisen tiedon muista tietolähteistä, joten sen puuttuminen herättää ymmärrettävästi huolta tieteellisen prosessin toimivuudesta. 
  - Replikaatiokriisin voi kuitenkin myös tulkita toisin: ilman kriittisyyttä omia (ja muiden) tuloksia kohtaan, ei mitään kriisiä olisikaan, joten silkka sen olemassaolo on osoitus tieteellisen prosessin toimivuudesta.

- Kun tuntee ja tunnistaa sattuman voiman ja ymmärtää kaikki mahdolliset satunnaisuuden lähteet, jotka altistavat tutkimusprosessin virheille, tulee samalla ymmärtäneeksi että eri tavoin koeteltu, useassa tutkimuksessa kumuloitunut tieto tulisi olla kaiken tieteen popularisoinnin keskiössä yksittäisten, mahdollisesti uusien ja yllättävien tutkimustulosten sijaan.
  - Tähän mennessä olemme jo oppineet, että tälle on myös vahvat tilastolliset perustelut: satunnaisen tiedon maailmassa mikään ei ole täysin varmaa, ei edes kaikkein edistyneimpien tilastomenetelmien avulla!
  
## Luvun 4 yhteenveto, keskeisiä termejä ja kokonaisuuksia.

-	Satunnaisilmiö
-	Satunnaismuuttuja
-	Jatkuvat ja diskreetit satunnaismuuttujat ja niihin liittyvät pistetodennäköisyysfunktio ja tiheysfunktio
-	Todennäköisyysjakauma
-	Tilastollinen malli (todennäköisyysmalli)
-	Kvalitatiiviset ja kvantitatiiviset muuttujat
-	Frekventistinen ja Bayesiläinen tilastotiede
-	Odotusarvo ja varianssi
-	Yleisempiä jakaumia: Normaalijakauma, Bernoulli-jakauma, binomijakauma ja Poisson-jakauma
-	Tieteen popularisointi ja sen suhde (yksittäiseen) tutkimukseen
